# é…’åº—ç»ç†ç«¯ API æ¥å£è§„èŒƒ

> å‰ç«¯æ–°å¢äº†é…’åº—ç»ç†æ§åˆ¶å°é¡µé¢ï¼Œéœ€è¦åç«¯å®ç°ä»¥ä¸‹æ¥å£ã€‚

---

## ğŸ†• æ–°å¢ HTTP æ¥å£ï¼ˆ4 ä¸ªï¼‰

### 1. è·å–æ‰€æœ‰æˆ¿é—´çš„æŠ¥è¡¨æ•°æ®

```
GET /api/manager/room-reports?startDate=2025-01-01&endDate=2025-01-15

Query å‚æ•°:
- startDate: å¼€å§‹æ—¥æœŸï¼ˆå¿…å¡«ï¼‰
- endDate: ç»“æŸæ—¥æœŸï¼ˆå¿…å¡«ï¼‰

å“åº”:
{
  "success": true,
  "reports": [
    {
      "roomId": "301",
      "isActive": true,                    // å½“å‰æ˜¯å¦å¼€æœº
      "totalDuration": 1200,               // æ€»ä½¿ç”¨æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
      "totalEnergy": 45.6,                 // æ€»èƒ½è€—ï¼ˆkWhï¼‰
      "totalFee": 68.40,                   // æ€»è´¹ç”¨ï¼ˆå…ƒï¼‰
      "avgTemperature": 24.5,              // å¹³å‡è®¾å®šæ¸©åº¦
      "mainFanSpeed": "Mid",               // ä¸»è¦é£é€Ÿï¼ˆä½¿ç”¨æœ€å¤šçš„ï¼‰
      "fanSpeedDistribution": {            // é£é€Ÿä½¿ç”¨åˆ†å¸ƒï¼ˆç™¾åˆ†æ¯”ï¼‰
        "Low": 30,
        "Mid": 50,
        "High": 20
      },
      "peakHours": "14:00-18:00"           // é«˜å³°ä½¿ç”¨æ—¶æ®µ
    }
    // ... å…¶ä»–æˆ¿é—´
  ]
}
```

---

### 2. è·å–å•ä¸ªæˆ¿é—´çš„è¯¦ç»†æŠ¥è¡¨

```
GET /api/manager/room-report/:roomId?startDate=2025-01-01&endDate=2025-01-15

ç¤ºä¾‹: GET /api/manager/room-report/301?startDate=2025-01-01&endDate=2025-01-15

å“åº”:
{
  "success": true,
  "report": {
    "roomId": "301",
    "isActive": true,
    "totalDuration": 1200,
    "totalEnergy": 45.6,
    "totalFee": 68.40,
    "avgTemperature": 24.5,
    "mainFanSpeed": "Mid",
    "fanSpeedDistribution": {
      "Low": 30,
      "Mid": 50,
      "High": 20
    },
    "peakHours": "14:00-18:00",
    "dailyUsage": [                        // æ¯æ—¥ä½¿ç”¨è¯¦æƒ…
      {
        "date": "2025-01-01",
        "duration": 180,
        "energy": 5.4,
        "fee": 8.10
      }
      // ...
    ]
  }
}
```

---

### 3. è·å–é…’åº—æ•´ä½“èƒ½è€—ç»Ÿè®¡

```
GET /api/manager/energy-stats?startDate=2025-01-01&endDate=2025-01-15

å“åº”:
{
  "success": true,
  "totalEnergy": 1234.56,                  // æ€»èƒ½è€—ï¼ˆkWhï¼‰
  "totalFee": 1851.84,                     // æ€»è´¹ç”¨ï¼ˆå…ƒï¼‰
  "activeRooms": 32,                       // å½“å‰å¼€æœºæˆ¿é—´æ•°
  "avgTemperature": 24.2,                  // å¹³å‡è®¾å®šæ¸©åº¦
  "peakHour": "15:00-17:00",               // ç”¨ç”µé«˜å³°æ—¶æ®µ
  "dailyAvgEnergy": 82.30                  // æ—¥å‡èƒ½è€—
}
```

---

### 4. è·å–æ¯æ—¥ç»Ÿè®¡æ•°æ®ï¼ˆç”¨äºå›¾è¡¨ï¼‰

```
GET /api/manager/daily-stats?startDate=2025-01-01&endDate=2025-01-15

å“åº”:
{
  "success": true,
  "stats": [
    {
      "date": "2025-01-01",
      "energy": 78.5,                      // å½“æ—¥æ€»èƒ½è€—ï¼ˆkWhï¼‰
      "fee": 117.75,                       // å½“æ—¥æ€»è´¹ç”¨ï¼ˆå…ƒï¼‰
      "activeRooms": 28,                   // å½“æ—¥å¼€æœºæˆ¿é—´æ•°
      "avgTemperature": 24.0               // å½“æ—¥å¹³å‡æ¸©åº¦
    },
    {
      "date": "2025-01-02",
      "energy": 85.2,
      "fee": 127.80,
      "activeRooms": 35,
      "avgTemperature": 24.5
    }
    // ... å…¶ä»–æ—¥æœŸ
  ]
}
```

---

## ğŸ“‹ æ•°æ®è®¡ç®—è¯´æ˜

### èƒ½è€—è®¡ç®—
```
æ€»èƒ½è€— = Î£ (å„æˆ¿é—´å„æ—¶æ®µçš„åŠŸç‡ Ã— æ—¶é•¿)
åŠŸç‡å‚è€ƒï¼š
- ä½é£ï¼š0.8 kW
- ä¸­é£ï¼š1.0 kW
- é«˜é£ï¼š1.2 kW
```

### è´¹ç”¨è®¡ç®—
```
æ€»è´¹ç”¨ = æ€»èƒ½è€— Ã— ç”µä»·
ç”µä»·å‚è€ƒï¼š1.5 å…ƒ/kWhï¼ˆæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼‰
```

### é«˜å³°æ—¶æ®µè®¡ç®—
```
ç»Ÿè®¡æ‰€æœ‰æˆ¿é—´æ¯å°æ—¶çš„æ€»èƒ½è€—ï¼Œæ‰¾å‡ºèƒ½è€—æœ€é«˜çš„è¿ç»­æ—¶æ®µ
```

---

## ğŸ“Š å‰ç«¯å±•ç¤ºè¯´æ˜

### æˆ¿é—´æŠ¥è¡¨é¢æ¿
- è¡¨æ ¼å±•ç¤ºæ‰€æœ‰æˆ¿é—´çš„èƒ½è€—æ•°æ®
- æ”¯æŒæŒ‰æˆ¿é—´å·/èƒ½è€—/è´¹ç”¨/æ—¶é•¿æ’åº
- ç‚¹å‡»"è¯¦æƒ…"æŸ¥çœ‹å•ä¸ªæˆ¿é—´çš„è¯¦ç»†æŠ¥è¡¨
- é«˜èƒ½è€—æˆ¿é—´ï¼ˆè¶…è¿‡å¹³å‡å€¼150%ï¼‰æ˜¾ç¤ºçº¢è‰²è­¦ç¤º

### èƒ½è€—ç»Ÿè®¡é¢æ¿
- æŸ±çŠ¶å›¾å±•ç¤ºæ¯æ—¥èƒ½è€—è¶‹åŠ¿
- èƒ½è€—åˆ†æå¡ç‰‡ï¼ˆæ—¥å‡èƒ½è€—ã€é«˜å³°æ—¶æ®µç­‰ï¼‰
- è´¹ç”¨åˆ†æå¡ç‰‡ï¼ˆæ—¥å‡è´¹ç”¨ã€å¹³å‡æ¯æˆ¿è´¹ç”¨ç­‰ï¼‰
- é«˜èƒ½è€—æˆ¿é—´æé†’åˆ—è¡¨
- èŠ‚èƒ½å»ºè®®

---

## ğŸ”— è®¿é—®åœ°å€

```
é…’åº—ç»ç†æ§åˆ¶å°: http://localhost:5173/manager
å‰å°æœåŠ¡å°: http://localhost:5173/reception
ç®¡ç†å‘˜æ§åˆ¶å°: http://localhost:5173/admin
å®¢æˆ·æˆ¿é—´é¢æ¿: http://localhost:5173/room/301
```

---

## ğŸ“ å‰ç«¯æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ managerStore.js              # ç»ç†ç«¯çŠ¶æ€ç®¡ç†
â”‚
â”œâ”€â”€ components/
â”‚   â””â”€â”€ manager/
â”‚       â”œâ”€â”€ ManagerDashBoard.vue     # ä¸»ç•Œé¢
â”‚       â”œâ”€â”€ RoomReportPanel.vue      # æˆ¿é—´æŠ¥è¡¨é¢æ¿
â”‚       â””â”€â”€ EnergyStatsPanel.vue     # èƒ½è€—ç»Ÿè®¡é¢æ¿
â”‚
â””â”€â”€ router/
    â””â”€â”€ index.js                     # æ·»åŠ  /manager è·¯ç”±
```

---

## ğŸ›  åç»­æ‰©å±•ï¼ˆæš‚ä¸å®ç°ï¼‰

- å¯¼å‡º Excel æŠ¥è¡¨
- å¯¼å‡º PDF æŠ¥å‘Š
- èƒ½è€—å¼‚å¸¸é¢„è­¦æ¨é€
- å†å²æ•°æ®å¯¹æ¯”åˆ†æ