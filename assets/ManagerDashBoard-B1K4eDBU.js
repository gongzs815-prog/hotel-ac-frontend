import{d as W,r as b,c as D,a as j,e as d,m as u,f as t,g as M,h as S,w as V,j as N,u as g,F as R,k as B,t as r,n as C,q as P,x as E,i as U,o as O,v as z,s as A}from"./index-zUhguFMv.js";const F="http://localhost:3000/api",L=W("manager",()=>{const y=b([]),x=b(null),n=b({totalEnergy:0,totalFee:0,activeRooms:0,avgTemperature:0,peakHour:null,dailyAvgEnergy:0}),m=b([]),c=b({startDate:_(),endDate:k()}),a=b(!1);function _(){const l=new Date;return l.setDate(l.getDate()-7),l.toISOString().split("T")[0]}function k(){return new Date().toISOString().split("T")[0]}const h=D(()=>[...y.value].sort((l,f)=>f.totalEnergy-l.totalEnergy)),o=D(()=>[...y.value].sort((l,f)=>f.totalFee-l.totalFee)),p=D(()=>{if(y.value.length===0)return[];const l=n.value.totalEnergy/y.value.length;return y.value.filter(f=>f.totalEnergy>l*1.5)}),v=D(()=>({totalRooms:y.value.length,activeRooms:y.value.filter(l=>l.isActive).length,totalEnergy:n.value.totalEnergy,totalFee:n.value.totalFee,avgTemperature:n.value.avgTemperature}));async function s(){try{a.value=!0;const l=await j.get(`${F}/manager/room-reports`,{params:{startDate:c.value.startDate,endDate:c.value.endDate}});l.data.success&&(y.value=l.data.reports,console.log("âœ… è·å–æˆ¿é—´æŠ¥è¡¨æˆåŠŸ:",y.value.length,"ä¸ªæˆ¿é—´"))}catch(l){throw console.error("âŒ è·å–æˆ¿é—´æŠ¥è¡¨å¤±è´¥:",l),l}finally{a.value=!1}}async function e(l){try{a.value=!0;const f=await j.get(`${F}/manager/room-report/${l}`,{params:{startDate:c.value.startDate,endDate:c.value.endDate}});if(f.data.success)return x.value=f.data.report,console.log("âœ… è·å–æˆ¿é—´è¯¦ç»†æŠ¥è¡¨æˆåŠŸ:",l),f.data.report}catch(f){throw console.error("âŒ è·å–æˆ¿é—´è¯¦ç»†æŠ¥è¡¨å¤±è´¥:",f),f}finally{a.value=!1}}async function i(){try{a.value=!0;const l=await j.get(`${F}/manager/energy-stats`,{params:{startDate:c.value.startDate,endDate:c.value.endDate}});l.data.success&&(n.value={totalEnergy:l.data.totalEnergy||0,totalFee:l.data.totalFee||0,activeRooms:l.data.activeRooms||0,avgTemperature:l.data.avgTemperature||0,peakHour:l.data.peakHour||null,dailyAvgEnergy:l.data.dailyAvgEnergy||0},console.log("âœ… è·å–èƒ½è€—ç»Ÿè®¡æˆåŠŸ"))}catch(l){throw console.error("âŒ è·å–èƒ½è€—ç»Ÿè®¡å¤±è´¥:",l),l}finally{a.value=!1}}async function w(){try{a.value=!0;const l=await j.get(`${F}/manager/daily-stats`,{params:{startDate:c.value.startDate,endDate:c.value.endDate}});l.data.success&&(m.value=l.data.stats||[],console.log("âœ… è·å–æ¯æ—¥ç»Ÿè®¡æˆåŠŸ:",m.value.length,"å¤©"))}catch(l){throw console.error("âŒ è·å–æ¯æ—¥ç»Ÿè®¡å¤±è´¥:",l),l}finally{a.value=!1}}function $(l,f){c.value.startDate=l,c.value.endDate=f}function T(){x.value=null}async function H(){try{a.value=!0,console.log("ğŸ”„ åˆå§‹åŒ–ç»ç†ç«¯æ•°æ®..."),await Promise.all([s(),i(),w()]),console.log("âœ… ç»ç†ç«¯æ•°æ®åˆå§‹åŒ–å®Œæˆ")}catch(l){throw console.error("âŒ åˆå§‹åŒ–å¤±è´¥:",l),l}finally{a.value=!1}}async function I(){await H()}return{roomReports:y,currentRoomReport:x,energyStats:n,dailyStats:m,dateRange:c,isLoading:a,roomsSortedByEnergy:h,roomsSortedByFee:o,highEnergyRooms:p,summary:v,fetchRoomReports:s,fetchRoomReport:e,fetchEnergyStats:i,fetchDailyStats:w,setDateRange:$,clearCurrentReport:T,initManagerData:H,refreshAllData:I}}),q={class:"flex items-center justify-between mb-6"},G={class:"flex items-center gap-3"},J=["title"],K={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Q={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},X={key:0,class:"text-center py-16"},Y={key:1,class:"overflow-x-auto"},Z={class:"w-full"},tt={class:"py-4"},et={class:"font-bold text-white"},st={class:"py-4"},ot={class:"py-4 text-right text-slate-300"},lt={class:"py-4 text-right"},nt={class:"py-4 text-right text-green-400 font-medium"},at={class:"py-4 text-center text-cyan-400"},rt={class:"py-4 text-center"},it={class:"py-4 text-center"},dt=["onClick"],ut={key:0,class:"text-center py-16 text-slate-500"},ct={class:"bg-slate-800 rounded-xl ring-1 ring-white/10 p-6 w-full max-w-lg mx-4 max-h-[80vh] overflow-y-auto"},xt={class:"flex justify-between items-center mb-4"},gt={class:"text-lg font-semibold text-white"},mt={class:"space-y-4"},vt={class:"grid grid-cols-2 gap-4"},pt={class:"bg-slate-900/50 rounded-lg p-3"},ht={class:"text-xl font-bold text-yellow-400"},ft={class:"bg-slate-900/50 rounded-lg p-3"},yt={class:"text-xl font-bold text-green-400"},bt={class:"bg-slate-900/50 rounded-lg p-3"},wt={class:"text-xl font-bold text-white"},kt={class:"bg-slate-900/50 rounded-lg p-3"},_t={class:"text-xl font-bold text-cyan-400"},$t={class:"bg-slate-900/50 rounded-lg p-4"},Dt={class:"space-y-2"},St={class:"flex items-center justify-between"},Ct={class:"flex-1 mx-3 h-2 bg-slate-700 rounded-full overflow-hidden"},Mt={class:"text-slate-400 text-sm w-12 text-right"},jt={class:"flex items-center justify-between"},Ft={class:"flex-1 mx-3 h-2 bg-slate-700 rounded-full overflow-hidden"},Et={class:"text-slate-400 text-sm w-12 text-right"},Rt={class:"flex items-center justify-between"},Bt={class:"flex-1 mx-3 h-2 bg-slate-700 rounded-full overflow-hidden"},Vt={class:"text-slate-400 text-sm w-12 text-right"},Lt={class:"bg-slate-900/50 rounded-lg p-4"},Ht={class:"text-white"},zt={class:"mt-6"},At={__name:"RoomReportPanel",emits:["error"],setup(y,{emit:x}){const n=L(),m=b("roomId"),c=b("asc"),a=b(null),_=D(()=>{const s=[...n.roomReports];return s.sort((e,i)=>{let w,$;switch(m.value){case"energy":w=e.totalEnergy||0,$=i.totalEnergy||0;break;case"fee":w=e.totalFee||0,$=i.totalFee||0;break;case"duration":w=e.totalDuration||0,$=i.totalDuration||0;break;default:w=e.roomId,$=i.roomId}return c.value==="asc"?w>$?1:-1:w<$?1:-1}),s});function k(s){if(!s)return"0åˆ†é’Ÿ";const e=Math.floor(s/60),i=s%60;return e>0?`${e}å°æ—¶${i>0?i+"åˆ†é’Ÿ":""}`:`${i}åˆ†é’Ÿ`}function h(s){if(!s)return"text-slate-400";const e=n.energyStats.totalEnergy/n.roomReports.length;return s>e*1.5?"text-red-400 font-medium":s>e?"text-yellow-400":"text-slate-300"}function o(s){return{Low:"ä½é£",Mid:"ä¸­é£",High:"é«˜é£"}[s]||"--"}function p(s){return{Low:"text-blue-400",Mid:"text-yellow-400",High:"text-red-400"}[s]||"text-slate-400"}function v(s){a.value=s}return(s,e)=>(u(),d("div",null,[t("div",q,[e[8]||(e[8]=t("h2",{class:"text-xl font-semibold text-white flex items-center"},[t("svg",{class:"w-6 h-6 mr-2 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),S(" æˆ¿é—´ç©ºè°ƒä½¿ç”¨æŠ¥è¡¨ ")],-1)),t("div",G,[V(t("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>m.value=i),class:"px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500"},[...e[5]||(e[5]=[t("option",{value:"roomId"},"æŒ‰æˆ¿é—´å·",-1),t("option",{value:"energy"},"æŒ‰èƒ½è€—",-1),t("option",{value:"fee"},"æŒ‰è´¹ç”¨",-1),t("option",{value:"duration"},"æŒ‰ä½¿ç”¨æ—¶é•¿",-1)])],512),[[N,m.value]]),t("button",{onClick:e[1]||(e[1]=i=>c.value=c.value==="asc"?"desc":"asc"),class:"p-2 bg-slate-900 border border-slate-700 rounded-lg text-slate-400 hover:text-white transition",title:c.value==="asc"?"å‡åº":"é™åº"},[c.value==="asc"?(u(),d("svg",K,[...e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"},null,-1)])])):(u(),d("svg",Q,[...e[7]||(e[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"},null,-1)])]))],8,J)])]),g(n).isLoading?(u(),d("div",X,[...e[9]||(e[9]=[t("svg",{class:"animate-spin h-10 w-10 mx-auto text-cyan-400",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),t("p",{class:"mt-3 text-slate-500"},"åŠ è½½ä¸­...",-1)])])):(u(),d("div",Y,[t("table",Z,[e[10]||(e[10]=t("thead",null,[t("tr",{class:"text-left text-slate-500 border-b border-slate-700"},[t("th",{class:"pb-3 font-medium"},"æˆ¿é—´å·"),t("th",{class:"pb-3 font-medium"},"çŠ¶æ€"),t("th",{class:"pb-3 font-medium text-right"},"ä½¿ç”¨æ—¶é•¿"),t("th",{class:"pb-3 font-medium text-right"},"èƒ½è€— (kWh)"),t("th",{class:"pb-3 font-medium text-right"},"è´¹ç”¨ (å…ƒ)"),t("th",{class:"pb-3 font-medium text-center"},"å¹³å‡æ¸©åº¦"),t("th",{class:"pb-3 font-medium text-center"},"ä¸»è¦é£é€Ÿ"),t("th",{class:"pb-3 font-medium text-center"},"æ“ä½œ")])],-1)),t("tbody",null,[(u(!0),d(R,null,B(_.value,i=>(u(),d("tr",{key:i.roomId,class:"border-b border-slate-700/50 hover:bg-slate-700/30 transition"},[t("td",tt,[t("span",et,r(i.roomId),1)]),t("td",st,[t("span",{class:C(["px-2 py-1 rounded-full text-xs font-medium",i.isActive?"bg-green-500/20 text-green-400":"bg-slate-500/20 text-slate-400"])},r(i.isActive?"è¿è¡Œä¸­":"å·²å…³é—­"),3)]),t("td",ot,r(k(i.totalDuration)),1),t("td",lt,[t("span",{class:C(h(i.totalEnergy))},r(i.totalEnergy?.toFixed(2)||"0.00"),3)]),t("td",nt," Â¥"+r(i.totalFee?.toFixed(2)||"0.00"),1),t("td",at,r(i.avgTemperature?.toFixed(1)||"--")+"Â°C ",1),t("td",rt,[t("span",{class:C(p(i.mainFanSpeed))},r(o(i.mainFanSpeed)),3)]),t("td",it,[t("button",{onClick:w=>v(i),class:"px-3 py-1 text-sm bg-cyan-600/20 text-cyan-400 rounded hover:bg-cyan-600/30 transition"}," è¯¦æƒ… ",8,dt)])]))),128))])]),_.value.length===0?(u(),d("div",ut,[...e[11]||(e[11]=[t("svg",{class:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("p",null,"æš‚æ— æŠ¥è¡¨æ•°æ®",-1)])])):M("",!0)])),a.value?(u(),d("div",{key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e[4]||(e[4]=P(i=>a.value=null,["self"]))},[t("div",ct,[t("div",xt,[t("h3",gt,"æˆ¿é—´ "+r(a.value.roomId)+" è¯¦ç»†æŠ¥è¡¨",1),t("button",{onClick:e[2]||(e[2]=i=>a.value=null),class:"text-slate-400 hover:text-white"},[...e[12]||(e[12]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",mt,[t("div",vt,[t("div",pt,[e[13]||(e[13]=t("p",{class:"text-slate-500 text-sm"},"æ€»èƒ½è€—",-1)),t("p",ht,r(a.value.totalEnergy?.toFixed(2))+" kWh",1)]),t("div",ft,[e[14]||(e[14]=t("p",{class:"text-slate-500 text-sm"},"æ€»è´¹ç”¨",-1)),t("p",yt,"Â¥"+r(a.value.totalFee?.toFixed(2)),1)]),t("div",bt,[e[15]||(e[15]=t("p",{class:"text-slate-500 text-sm"},"ä½¿ç”¨æ—¶é•¿",-1)),t("p",wt,r(k(a.value.totalDuration)),1)]),t("div",kt,[e[16]||(e[16]=t("p",{class:"text-slate-500 text-sm"},"å¹³å‡æ¸©åº¦",-1)),t("p",_t,r(a.value.avgTemperature?.toFixed(1))+"Â°C",1)])]),t("div",$t,[e[20]||(e[20]=t("p",{class:"text-slate-300 font-medium mb-3"},"é£é€Ÿä½¿ç”¨åˆ†å¸ƒ",-1)),t("div",Dt,[t("div",St,[e[17]||(e[17]=t("span",{class:"text-blue-400"},"ä½é£",-1)),t("div",Ct,[t("div",{class:"h-full bg-blue-400 rounded-full",style:E({width:(a.value.fanSpeedDistribution?.Low||0)+"%"})},null,4)]),t("span",Mt,r(a.value.fanSpeedDistribution?.Low||0)+"%",1)]),t("div",jt,[e[18]||(e[18]=t("span",{class:"text-yellow-400"},"ä¸­é£",-1)),t("div",Ft,[t("div",{class:"h-full bg-yellow-400 rounded-full",style:E({width:(a.value.fanSpeedDistribution?.Mid||0)+"%"})},null,4)]),t("span",Et,r(a.value.fanSpeedDistribution?.Mid||0)+"%",1)]),t("div",Rt,[e[19]||(e[19]=t("span",{class:"text-red-400"},"é«˜é£",-1)),t("div",Bt,[t("div",{class:"h-full bg-red-400 rounded-full",style:E({width:(a.value.fanSpeedDistribution?.High||0)+"%"})},null,4)]),t("span",Vt,r(a.value.fanSpeedDistribution?.High||0)+"%",1)])])]),t("div",Lt,[e[21]||(e[21]=t("p",{class:"text-slate-300 font-medium mb-2"},"é«˜å³°ä½¿ç”¨æ—¶æ®µ",-1)),t("p",Ht,r(a.value.peakHours||"æš‚æ— æ•°æ®"),1)])]),t("div",zt,[t("button",{onClick:e[3]||(e[3]=i=>a.value=null),class:"w-full px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition"}," å…³é—­ ")])])])):M("",!0)]))}},Tt={key:0,class:"text-center py-16"},It={key:1,class:"space-y-6"},Wt={class:"bg-slate-900/50 rounded-lg p-4"},Nt={key:0,class:"text-center py-8 text-slate-500"},Pt={key:1,class:"h-64 flex items-end justify-between gap-2"},Ut=["title"],Ot={class:"mt-2 text-xs text-slate-500 transform -rotate-45 origin-top-left whitespace-nowrap"},qt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Gt={class:"bg-slate-900/50 rounded-lg p-4"},Jt={class:"space-y-3"},Kt={class:"flex justify-between items-center py-2 border-b border-slate-700"},Qt={class:"text-white font-medium"},Xt={class:"flex justify-between items-center py-2 border-b border-slate-700"},Yt={class:"text-white font-medium"},Zt={class:"flex justify-between items-center py-2 border-b border-slate-700"},te={class:"text-white font-medium"},ee={class:"flex justify-between items-center py-2"},se={class:"text-yellow-400 font-bold text-lg"},oe={class:"bg-slate-900/50 rounded-lg p-4"},le={class:"space-y-3"},ne={class:"flex justify-between items-center py-2 border-b border-slate-700"},ae={class:"text-white font-medium"},re={class:"flex justify-between items-center py-2 border-b border-slate-700"},ie={class:"text-white font-medium"},de={class:"flex justify-between items-center py-2 border-b border-slate-700"},ue={class:"text-white font-medium"},ce={class:"flex justify-between items-center py-2"},xe={class:"text-green-400 font-bold text-lg"},ge={key:0,class:"bg-red-500/10 border border-red-500/30 rounded-lg p-4"},me={class:"flex flex-wrap gap-2"},ve={__name:"EnergyStatsPanel",emits:["error"],setup(y,{emit:x}){const n=L(),m=D(()=>n.dailyStats.length===0?0:n.energyStats.totalFee/n.dailyStats.length),c=D(()=>n.roomReports.length===0?0:n.energyStats.totalFee/n.roomReports.length),a=D(()=>n.dailyStats.length===0?1:Math.max(...n.dailyStats.map(h=>h.energy||0)));function _(h){return!h||a.value===0?5:Math.max(5,h/a.value*100)}function k(h){if(!h)return"";const o=new Date(h);return`${o.getMonth()+1}/${o.getDate()}`}return(h,o)=>(u(),d("div",null,[o[16]||(o[16]=t("h2",{class:"text-xl font-semibold text-white mb-6 flex items-center"},[t("svg",{class:"w-6 h-6 mr-2 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),S(" èƒ½è€—ç»Ÿè®¡åˆ†æ ")],-1)),g(n).isLoading?(u(),d("div",Tt,[...o[0]||(o[0]=[t("svg",{class:"animate-spin h-10 w-10 mx-auto text-cyan-400",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),t("p",{class:"mt-3 text-slate-500"},"åŠ è½½ä¸­...",-1)])])):(u(),d("div",It,[t("div",Wt,[o[1]||(o[1]=t("h3",{class:"text-md font-medium text-slate-300 mb-4"},"æ¯æ—¥èƒ½è€—è¶‹åŠ¿",-1)),g(n).dailyStats.length===0?(u(),d("div",Nt," æš‚æ— æ•°æ® ")):(u(),d("div",Pt,[(u(!0),d(R,null,B(g(n).dailyStats,(p,v)=>(u(),d("div",{key:v,class:"flex-1 flex flex-col items-center"},[t("div",{class:"w-full bg-cyan-500/80 rounded-t transition-all hover:bg-cyan-400",style:E({height:_(p.energy)+"%"}),title:`${p.date}: ${p.energy?.toFixed(2)} kWh`},null,12,Ut),t("div",Ot,r(k(p.date)),1)]))),128))])),o[2]||(o[2]=t("div",{class:"mt-8 flex justify-center gap-6 text-sm text-slate-500"},[t("div",{class:"flex items-center gap-2"},[t("div",{class:"w-3 h-3 bg-cyan-500 rounded"}),t("span",null,"èƒ½è€— (kWh)")])],-1))]),t("div",qt,[t("div",Gt,[o[7]||(o[7]=t("h3",{class:"text-md font-medium text-slate-300 mb-4"},"èƒ½è€—åˆ†æ",-1)),t("div",Jt,[t("div",Kt,[o[3]||(o[3]=t("span",{class:"text-slate-400"},"æ—¥å‡èƒ½è€—",-1)),t("span",Qt,r(g(n).energyStats.dailyAvgEnergy?.toFixed(2)||"0")+" kWh",1)]),t("div",Xt,[o[4]||(o[4]=t("span",{class:"text-slate-400"},"ç”¨ç”µé«˜å³°æ—¶æ®µ",-1)),t("span",Yt,r(g(n).energyStats.peakHour||"æš‚æ— æ•°æ®"),1)]),t("div",Zt,[o[5]||(o[5]=t("span",{class:"text-slate-400"},"ç»Ÿè®¡å¤©æ•°",-1)),t("span",te,r(g(n).dailyStats.length)+" å¤©",1)]),t("div",ee,[o[6]||(o[6]=t("span",{class:"text-slate-400"},"æ€»èƒ½è€—",-1)),t("span",se,r(g(n).energyStats.totalEnergy?.toFixed(2)||"0")+" kWh",1)])])]),t("div",oe,[o[12]||(o[12]=t("h3",{class:"text-md font-medium text-slate-300 mb-4"},"è´¹ç”¨åˆ†æ",-1)),t("div",le,[t("div",ne,[o[8]||(o[8]=t("span",{class:"text-slate-400"},"æ—¥å‡è´¹ç”¨",-1)),t("span",ae,"Â¥"+r(m.value.toFixed(2)),1)]),t("div",re,[o[9]||(o[9]=t("span",{class:"text-slate-400"},"å¹³å‡æ¯æˆ¿è´¹ç”¨",-1)),t("span",ie,"Â¥"+r(c.value.toFixed(2)),1)]),t("div",de,[o[10]||(o[10]=t("span",{class:"text-slate-400"},"å‚ä¸æˆ¿é—´æ•°",-1)),t("span",ue,r(g(n).roomReports.length)+" é—´",1)]),t("div",ce,[o[11]||(o[11]=t("span",{class:"text-slate-400"},"æ€»è´¹ç”¨",-1)),t("span",xe,"Â¥"+r(g(n).energyStats.totalFee?.toFixed(2)||"0"),1)])])])]),g(n).highEnergyRooms.length>0?(u(),d("div",ge,[o[13]||(o[13]=t("h3",{class:"text-md font-medium text-red-400 mb-3 flex items-center"},[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),S(" é«˜èƒ½è€—æˆ¿é—´æé†’ ")],-1)),o[14]||(o[14]=t("p",{class:"text-slate-400 text-sm mb-3"},"ä»¥ä¸‹æˆ¿é—´èƒ½è€—è¶…è¿‡å¹³å‡å€¼çš„ 150%ï¼Œå»ºè®®å…³æ³¨ï¼š",-1)),t("div",me,[(u(!0),d(R,null,B(g(n).highEnergyRooms,p=>(u(),d("span",{key:p.roomId,class:"px-3 py-1 bg-red-500/20 text-red-400 rounded-full text-sm"},r(p.roomId)+" ("+r(p.totalEnergy?.toFixed(1))+" kWh) ",1))),128))])])):M("",!0),o[15]||(o[15]=U('<div class="bg-slate-900/50 rounded-lg p-4"><h3 class="text-md font-medium text-slate-300 mb-3">èŠ‚èƒ½å»ºè®®</h3><ul class="space-y-2 text-sm text-slate-400"><li class="flex items-start gap-2"><svg class="w-4 h-4 text-cyan-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg><span>å»ºè®®å°†ç©ºè°ƒæ¸©åº¦è®¾ç½®åœ¨ 24-26Â°Cï¼Œæ¯å‡é«˜ 1Â°C å¯èŠ‚èƒ½çº¦ 6%</span></li><li class="flex items-start gap-2"><svg class="w-4 h-4 text-cyan-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg><span>ä½¿ç”¨ä¸­ä½é£é€Ÿå¯ä»¥åœ¨ä¿è¯èˆ’é€‚åº¦çš„åŒæ—¶é™ä½èƒ½è€—</span></li><li class="flex items-start gap-2"><svg class="w-4 h-4 text-cyan-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg><span>å…³æ³¨é«˜èƒ½è€—æˆ¿é—´ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨é—¨çª—æœªå…³é—­ç­‰é—®é¢˜</span></li></ul></div>',1))]))]))}},pe={class:"min-h-screen bg-slate-900 text-slate-300 p-6"},he={class:"mb-6"},fe={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},ye={class:"flex items-center gap-4"},be={class:"flex items-center gap-2 bg-slate-800 p-2 rounded-lg ring-1 ring-white/10"},we=["disabled"],ke={key:0,class:"mt-4 p-3 bg-red-500/10 border border-red-500/50 rounded-lg text-red-400 text-sm flex items-center justify-between"},_e={class:"flex items-center"},$e={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},De={class:"bg-slate-800 rounded-xl p-4 ring-1 ring-white/10"},Se={class:"flex items-center justify-between"},Ce={class:"text-2xl font-bold text-white mt-1"},Me={class:"bg-slate-800 rounded-xl p-4 ring-1 ring-white/10"},je={class:"flex items-center justify-between"},Fe={class:"text-2xl font-bold text-white mt-1"},Ee={class:"bg-slate-800 rounded-xl p-4 ring-1 ring-white/10"},Re={class:"flex items-center justify-between"},Be={class:"text-2xl font-bold text-white mt-1"},Ve={class:"bg-slate-800 rounded-xl p-4 ring-1 ring-white/10"},Le={class:"flex items-center justify-between"},He={class:"text-2xl font-bold text-white mt-1"},ze={class:"mb-6"},Ae={class:"flex space-x-2 bg-slate-800 p-1 rounded-xl w-fit"},Te=["onClick"],Ie={class:"text-xl"},We={class:"bg-slate-800 rounded-xl ring-1 ring-white/10 p-6"},Ne={key:0},Pe={key:1},Oe={__name:"ManagerDashBoard",setup(y){const x=L(),n=b("roomReport"),m=b(""),c=b(x.dateRange.startDate),a=b(x.dateRange.endDate),_=[{id:"roomReport",label:"æˆ¿é—´æŠ¥è¡¨",icon:"ğŸ“‹"},{id:"energyStats",label:"èƒ½è€—ç»Ÿè®¡",icon:"ğŸ“Š"}];function k(v){return v==null?"0":v.toLocaleString("zh-CN",{maximumFractionDigits:2})}async function h(){x.setDateRange(c.value,a.value);try{await x.refreshAllData()}catch(v){m.value="æŸ¥è¯¢å¤±è´¥: "+(v.message||"æœªçŸ¥é”™è¯¯")}}async function o(){try{await x.refreshAllData()}catch(v){m.value="åˆ·æ–°å¤±è´¥: "+(v.message||"æœªçŸ¥é”™è¯¯")}}function p(v){m.value=v}return O(async()=>{console.log("ğŸ“Š é…’åº—ç»ç†æ§åˆ¶å°åŠ è½½...");try{await x.initManagerData()}catch{m.value="åŠ è½½æ•°æ®å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•"}}),(v,s)=>(u(),d("div",pe,[t("header",he,[t("div",fe,[s[5]||(s[5]=t("div",null,[t("h1",{class:"text-2xl font-bold text-white flex items-center"},[t("svg",{class:"w-8 h-8 mr-3 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),S(" é…’åº—ç»ç†æ§åˆ¶å° ")]),t("p",{class:"text-slate-500 text-sm mt-1"},"ç©ºè°ƒèƒ½è€—ç»Ÿè®¡ä¸æŠ¥è¡¨åˆ†æ")],-1)),t("div",ye,[t("div",be,[V(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e),type:"date",class:"px-3 py-1.5 bg-slate-900 border border-slate-700 rounded text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500"},null,512),[[z,c.value]]),s[3]||(s[3]=t("span",{class:"text-slate-500"},"è‡³",-1)),V(t("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>a.value=e),type:"date",class:"px-3 py-1.5 bg-slate-900 border border-slate-700 rounded text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500"},null,512),[[z,a.value]]),t("button",{onClick:h,class:"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white text-sm rounded transition"}," æŸ¥è¯¢ ")]),t("button",{onClick:o,disabled:g(x).isLoading,class:"p-2 rounded-lg bg-slate-800 hover:bg-slate-700 transition ring-1 ring-white/10 disabled:opacity-50",title:"åˆ·æ–°æ•°æ®"},[(u(),d("svg",{class:C(["w-5 h-5",g(x).isLoading?"animate-spin":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[4]||(s[4]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))],8,we)])]),m.value?(u(),d("div",ke,[t("div",_e,[s[6]||(s[6]=t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,r(m.value),1)]),t("button",{onClick:s[2]||(s[2]=e=>m.value=""),class:"text-red-400 hover:text-red-300"},[...s[7]||(s[7]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])):M("",!0)]),t("div",$e,[t("div",De,[t("div",Se,[t("div",null,[s[9]||(s[9]=t("p",{class:"text-slate-500 text-sm"},"æ€»èƒ½è€—",-1)),t("p",Ce,[S(r(k(g(x).energyStats.totalEnergy))+" ",1),s[8]||(s[8]=t("span",{class:"text-sm font-normal text-slate-400"},"kWh",-1))])]),s[10]||(s[10]=t("div",{class:"p-3 bg-yellow-500/20 rounded-lg"},[t("svg",{class:"w-6 h-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1))])]),t("div",Me,[t("div",je,[t("div",null,[s[11]||(s[11]=t("p",{class:"text-slate-500 text-sm"},"æ€»è´¹ç”¨",-1)),t("p",Fe," Â¥"+r(k(g(x).energyStats.totalFee)),1)]),s[12]||(s[12]=t("div",{class:"p-3 bg-green-500/20 rounded-lg"},[t("svg",{class:"w-6 h-6 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]),t("div",Ee,[t("div",Re,[t("div",null,[s[14]||(s[14]=t("p",{class:"text-slate-500 text-sm"},"å½“å‰å¼€æœº",-1)),t("p",Be,[S(r(g(x).energyStats.activeRooms)+" ",1),s[13]||(s[13]=t("span",{class:"text-sm font-normal text-slate-400"},"é—´",-1))])]),s[15]||(s[15]=t("div",{class:"p-3 bg-cyan-500/20 rounded-lg"},[t("svg",{class:"w-6 h-6 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1))])]),t("div",Ve,[t("div",Le,[t("div",null,[s[17]||(s[17]=t("p",{class:"text-slate-500 text-sm"},"å¹³å‡æ¸©åº¦",-1)),t("p",He,[S(r(g(x).energyStats.avgTemperature?.toFixed(1)||"--")+" ",1),s[16]||(s[16]=t("span",{class:"text-sm font-normal text-slate-400"},"Â°C",-1))])]),s[18]||(s[18]=t("div",{class:"p-3 bg-blue-500/20 rounded-lg"},[t("svg",{class:"w-6 h-6 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])],-1))])])]),t("div",ze,[t("div",Ae,[(u(),d(R,null,B(_,e=>t("button",{key:e.id,onClick:i=>n.value=e.id,class:C(["px-6 py-3 rounded-lg font-medium transition flex items-center gap-2",n.value===e.id?"bg-cyan-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-slate-700"])},[t("span",Ie,r(e.icon),1),t("span",null,r(e.label),1)],10,Te)),64))])]),t("div",We,[n.value==="roomReport"?(u(),d("div",Ne,[A(At,{onError:p})])):n.value==="energyStats"?(u(),d("div",Pe,[A(ve,{onError:p})])):M("",!0)])]))}};export{Oe as default};
